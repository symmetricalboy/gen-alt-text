name: Deploy Dev Site to gh-pages-dev

on:
  push:
    branches:
      - dev
  workflow_dispatch: # Allows manual triggering from the Actions tab

permissions:
  contents: write # Required to push to the gh-pages-dev branch

jobs:
  build-and-deploy-dev:
    name: Build and Deploy Dev Site
    runs-on: ubuntu-latest
    steps:
      - name: Checkout dev branch
        uses: actions/checkout@v4
        with:
          ref: dev # Ensure we are checking out the dev branch

      # --- (OPTIONAL) ADD YOUR BUILD STEPS HERE ---
      # If your site is just static HTML/CSS/JS and needs no build, you can skip this.
      # Example for a Node.js project (e.g., React, Vue, SvelteKit, Eleventy):
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # Specify your Node.js version
          cache: 'npm' # Or 'yarn' or 'pnpm'
      
      - name: Install dependencies
        run: npm install
      
      - name: Build project
        run: npm run build
      #   # Ensure your build output goes to a consistent directory, e.g., 'dist', 'build', 'public'
      #   # Let's assume the build output is in a directory called 'build_output' for this example
      #
      # --- END OF BUILD STEPS ---

      - name: Deploy to gh-pages-dev branch
        uses: peaceiris/actions-gh-pages@v4 # Or the latest version available
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_branch: gh-pages-dev # The branch to deploy the dev site to
          
          # If NO build step, and your files are at the root of the 'dev' branch:
          publish_dir: .
          
          # If you HAVE a build step, point to your build output directory:
          # publish_dir: ./build_output # Example: use the directory name from your build step

          cname: alttextdev.symm.app # Explicitly set the CNAME for the dev site here
          
          user_name: 'github-actions[bot]'
          user_email: 'github-actions[bot]@users.noreply.github.com'
          commit_message: 'Deploy dev site from ${{ github.sha }} to gh-pages-dev'
          # force_orphan: true # Optional: Creates a clean history for the publish_branch. Use with caution.